<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8" name="Author" content="Douglas Lau"/>
	<link href="iris_doc.css" rel="stylesheet" type="text/css"/>
	<title>IRIS Administrator Guide</title>
	<script type="text/javascript" src="admin_guide.js"></script>
</head>

<body>
<nav class="sidebar">
  <h1><a id="contents_link" href="#admin_guide">Contents</a></h1>
  <div id="contents_div"><!-- div required for js, DO NOT REMOVE --></div>
  <h2><a id="overview_link" href="#overview">Overview</a></h2>
  <div id="overview_div">
    <h3><a href="#architecture">System Architecture</a></h3>
    <h3><a href="#device_types">Device Types</a></h3>
    <h3><a href="#protocols">Protocols</a></h3>
    <h3><a href="#advanced_features">Advanced Features</a></h3>
  </div>
  <h2><a id="installation_link" href="#installation">Installation</a></h2>
  <div id="installation_div">
    <h3><a href="#operating_system">Operating System</a></h3>
    <h3><a href="#install_iris">Install IRIS</a></h3>
    <h3><a href="#init_iris">Initialize IRIS</a></h3>
    <h3><a href="#server_properties">Server Properties</a></h3>
    <h3><a href="#start_services">Start Services</a></h3>
    <h3><a href="#initial_login">Initial Login</a></h3>
  </div>
  <h2><a id="basic_setup_link" href="#basic_setup">Basic Setup</a></h2>
  <div id="basic_setup_div">
    <h3><a href="#client_properties">Client Properties</a></h3>
    <h3><a href="#user_properties">User Properties</a></h3>
    <h3><a href="#edit_mode">Edit Mode</a></h3>
    <h3><a href="#sys_attr">System Attributes</a></h3>
    <h3><a href="#users_and_roles">Users and Roles</a></h3>
    <h3><a href="#mapping">Mapping</a></h3>
    <h3><a href="road_topology.html">Road Topology</a></h3>
    <h3><a href="#comm_links">Comm Links</a></h3>
    <h3><a href="controllers.html">Controllers</a></h3>
    <h3><a href="fonts.html">Fonts</a></h3>
  </div>
  <h2><a id="devices_link" href="controllers.html#devices">Devices</a></h2>
  <div id="devices_div">
    <h3><a href="dms.html">Dynamic Message Signs</a></h3>
    <h3><a href="lcs.html">Lane-Use Control Signs</a></h3>
    <h3><a href="vehicle_detection.html">Vehicle Detection</a></h3>
    <h3><a href="cameras.html">Cameras</a></h3>
    <h3><a href="video.html">Video Monitors</a></h3>
    <h3><a href="ramp_meters.html">Ramp Meters</a></h3>
    <h3><a href="gate_arms.html">Gate Arms</a></h3>
    <h3><a href="tolling.html#tag-readers">Tag Readers</a></h3>
    <h3><a href="beacons.html">Beacons</a></h3>
    <h3><a href="alarms.html">Alarms</a></h3>
    <h3><a href="rwis.html">Road Weather Information Systems</a></h3>
    <h3><a href="gps.html">GPS</a></h3>
  </div>
  <h2><a id="features_link" href="#features">Features</a></h2>
  <div id="features_div">
    <h3><a href="vehicle_detection.html#traffic-map">Traffic Map Layer</a></h3>
    <h3><a href="incidents.html">Incident Management</a></h3>
    <h3><a href="action_plans.html">Action Plans</a></h3>
    <h3><a href="ramp_meters.html#metering-strategies">Ramp Metering Strategies</a></h3>
    <h3><a href="travel_time.html">Travel Time Estimation</a></h3>
    <h3><a href="slow_warning.html">Slow Traffic Warning</a></h3>
    <h3><a href="tolling.html">Tolling</a></h3>
    <h3><a href="parking_areas.html">Parking Area Availability</a></h3>
    <h3><a href="vsa.html">Variable Speed Advisory</a></h3>
  </div>
  <h2><a id="troubleshooting_link" href="troubleshooting.html">Troubleshooting</a></h2>
  <h2><a id="maintenance_link" href="maintenance.html">Maintenance</a></h2>
  <h2><a id="development_link" href="development.html">Development</a></h2>
  <h2><a id="stepbystep_link" href="step_by_step.html">Step-by-Step</a></h2>
</nav>

<main class="mainbar">
<header>
<div id="stamp">27 Sep 2019</div>
</header>
<h1 id="admin_guide"><span class="left"><img src="iris_icon.svg"/></span>
	IRIS Administrator Guide</h1>

<h2 id="overview">Overview</h2>
<p>
	IRIS is an <a href="http://www.opensource.org/docs/osd">open source</a>
	advanced traffic management system.
	It provides an integrated platform for transportation agencies to
	manage traffic monitoring and control devices.
	The software is written in <a href="http://www.java.com">Java</a> and
	licensed for anyone to use under the
	<a href="http://www.gnu.org/licenses/old-licenses/gpl-2.0.html">GPL</a>.
	In addition, all dependencies required to install and operate an IRIS
	system are available as free software.
	IRIS stands for Intelligent Roadway Information System.
</p>
<p>
	The IRIS software presents an intuitive map-based interface to system
	operators.
	This user interface has been refined over many iterations by getting
	feedback from operators to streamline their workflow.
</p>

<h3 id="architecture">System Architecture</h3>

<figure>
<svg class="right" xmlns="http://www.w3.org/2000/svg" version="1.1"
     width="640" height="480">
  <title>System Architecture</title>
  <defs>
    <marker id="Arrow1Mend" orient="auto" style="overflow:visible">
      <path d="M 0,0 5,-5 -12.5,0 5,5 0,0 z"
            transform="matrix(-0.4,0,0,-0.4,-4,0)"
            style="stroke:#000;stroke-width:1pt;marker-start:none"/>
    </marker>
  </defs>
  <g style="font-size:20px;font-family:Liberation Sans">
    <text style="font-size:28px">
      <tspan x="384" y="64">IRIS System</tspan>
      <tspan x="384" y="94">Architecture</tspan>
    </text>
    <g transform="translate(112,24)">
      <g style="fill:#c4f9ff;stroke:#000;stroke-width:2">
        <g style="opacity:0.5">
          <rect x="16" y="16" width="200" height="88" ry="8"
                style="opacity:0.5"/>
          <rect x="8" y="8" width="200" height="88" ry="8"/>
        </g>
        <rect x="0" y="0" width="200" height="88" ry="8"/>
      </g>
      <text>
        <tspan x="48" y="48">IRIS Clients</tspan>
      </text>
    </g>
    <g transform="translate(16,176)">
      <rect x="0" y="0" width="176" height="104" ry="8"
        style="fill:#ffe6c4;stroke:#000;stroke-width:2"/>
      <text>
        <tspan x="16" y="40">Apache Server</tspan>
        <tspan x="24" y="60">- Client JARs</tspan>
        <tspan x="24" y="80">- Map Tiles</tspan>
      </text>
    </g>
    <g transform="translate(232,176)">
      <rect x="0" y="0" width="192" height="120" ry="8"
            style="fill:#e2c4ff;stroke:#000;stroke-width:2"/>
      <text>
        <tspan x="40" y="60">IRIS Server</tspan>
      </text>
    </g>
    <g transform="translate(464,188)">
      <rect x="0" y="0" width="160" height="108" ry="8"
        style="fill:#d0ffc4;stroke:#000;stroke-width:2"/>
      <text style="font-size:18px">
        <tspan x="16" y="40">Authentication</tspan>
        <tspan x="16" y="60">Server (LDAP)</tspan>
        <tspan x="32" y="80" style="font-style:italic">(Optional)</tspan>
      </text>
    </g>
    <g transform="translate(16,340)">
      <rect x="0" y="0" width="144" height="88" ry="8"
        style="fill:#f6ffc4;stroke:#000;stroke-width:2" />
      <text>
        <tspan x="16" y="40">Honeybee</tspan>
        <tspan x="24" y="60">- JSON files</tspan>
      </text>
    </g>
    <g transform="translate(200,360)">
      <rect x="0" y="0" width="152" height="88" ry="8"
        style="fill:#c4d1ff;stroke:#000;stroke-width:2" />
      <text>
        <tspan x="16" y="40">Database</tspan>
        <tspan x="16" y="60">(PostgreSQL)</tspan>
      </text>
    </g>
    <g transform="translate(392,360)">
      <g style="fill:#f6ffc4;stroke:#000;stroke-width:2">
        <g style="opacity:0.5">
          <rect x="16" y="16" width="208" height="88" ry="8"
                style="opacity:0.5"/>
          <rect x="8" y="8" width="208" height="88" ry="8"/>
        </g>
        <rect x="0" y="0" width="208" height="88" ry="8"/>
      </g>
      <text style="font-size:18px">
        <tspan x="16" y="40">Traffic Monitoring</tspan>
        <tspan x="16" y="60">and Control Devices</tspan>
      </text>
    </g>
    <g style="stroke:#000;stroke-width:2;marker-end:url(#Arrow1Mend)">
      <path d="m 176,112 -32,64"/>
      <path d="m 256,112 32,64"/>
      <path d="m 424,240 40,8"/>
      <path d="m 160,374 40,16"/>
      <path d="m 300,296 -32,64"/>
      <path d="m 392,296 32,64"/>
    </g>
  </g>
</svg>
</figure>

<p>
	The software has a client/server architecture.
	System configuration data is stored in a
	<a href="http://www.postgresql.org">PostgreSQL</a> database,
	and managed by the IRIS server.
	The server also handles communication with all traffic control and
	data collection devices.
	The client software is distributed by an <a
	href="http://projects.apache.org/projects/http_server.html">Apache</a>
	web server, using Java Web Start.
	All communication between the server and clients is encrypted using
	secure socket layer (SSL).
	The server may be configured to pass authentication requests off to an
	external LDAP server, allowing IRIS to integrate into an existing
	authentication system.
</p>

<h3 id="device_types">Device Types</h3>
<p>
	IRIS is able to manage several different types of traffic monitoring and
	control devices.
	These include:
</p>
<ul>
	<li><a href="dms.html">DMS</a> (dynamic message signs)</li>
	<li><a href="cameras.html">Cameras</a> and
	    <a href="video.hdml">Video monitors</a>
	</li>
	<li><a href="vehicle_detection.html">VDS</a> (vehicle detection systems)</li>
	<li><a href="lcs.html">LCS</a> (lane-use control signs)</li>
	<li><a href="ramp_meters.html">Ramp meters</a></li>
	<li><a href="gate_arms.html">Gate Arms</a></li>
	<li><a href="tolling.html#tag-readers">Tag Readers</a></li>
	<li><a href="beacons.html">Beacons</a></li>
	<li><a href="rwis.html">RWIS</a> (road-weather information systems)</li>
	<li><a href="gps.html">GPS</a> (global positioning system)</li>
	<li><a href="alarms.html">Alarms</a></li>
</ul>
<h3 id="protocols">Protocols</h3>
<p>
	Many different protocols are supported for communicating with
	various device types.
	Additional protocols can be added for any existing device type by
	programming a simple driver interface.
	These are some existing protocols:
</p>
<ul>
	<li><a href="#ntcip">NTCIP</a></li>
	<li><a href="#dms_xml">DMS-XML</a></li>
	<li><a href="#mndot170">MnDOT-170</a></li>
	<li><a href="#ss105">Wavetronix SmartSensor SS105</a></li>
	<li><a href="#ss125">Wavetronix SmartSensor HD SS125</a></li>
	<li><a href="#g4">RTMS G4</a></li>
	<li><a href="#canoga">GTT Canoga Traffic Sensing System</a></li>
	<li><a href="#dr500">Houston Radar DR-500 Doppler</a></li>
	<li><a href="#dxm">Banner Engineering DXM Magnetometer</a></li>
	<li><a href="#axis_ptz">Axis Camera PTZ</a></li>
	<li><a href="#pelcod">Pelco-D PTZ</a></li>
	<li><a href="#manchester">American Dynamics Manchester PTZ</a></li>
	<li><a href="#vicon">Vicon Camera PTZ</a></li>
	<li><a href="#cohu">Cohu Camera PTZ</a></li>
	<li><a href="#infinova">Infinova Camera PTZ</a></li>
	<li><a href="#pelcop">Pelco-P Keyboard</a></li>
	<li><a href="video.html#monstream">MonStream</a></li>
	<li><a href="#stc">HySecurity SmartTouch Controller STC</a></li>
	<li><a href="#e6">Transcore Encompass 6 E6</a></li>
	<li><a href="#redlion">RedLion modem GPS</a></li>
	<li><a href="#sierragx">SierraGX modem GPS</a></li>
	<li><a href="#dinrelay">Digital Loggers Inc. DIN-Relay</a></li>
	<li><a href="#cbw">Xytronix Control By Web CBW</a></li>
	<li><a href="#org815">Optical Scientific ORG-815</a></li>
	<li><a href="#msgfeed">DMS Message Feed</a></li>
	<li><a href="#incfeed">Incident Feed</a></li>
</ul>
<h3 id="advanced_features">Advanced Features</h3>
<p>
	IRIS contains these higher-level traffic management features:
</p>
<ul>
	<li>Continuously updated <a href="vehicle_detection.html#traffic-map">traffic map</a>
	</li>
	<li><a href="incidents.html">Incident management</a></li>
	<li><a href="action_plans.html">Scheduled</a> deployment of control
	    devices</li>
	<li>Coördinated <a href="ramp_meters.html#metering-strategies">ramp
	    metering strategies</a></li>
	<li><a href="travel_time.html">Travel time</a> estimation</li>
	<li><a href="slow_warning.html">Slow traffic warning</a></li>
	<li><a href="tolling.html">Toll</a> lane operation</li>
	<li><a href="parking_areas.html">Parking area</a> availability</li>
</ul>

<h2 id="installation">Installation</h2>
<p/>

<h3 id="operating_system">Operating System</h3>
<p>
	Install <a href="http://fedoraproject.org">Fedora</a> onto the server
	computer.
	Other operating systems, such as Red Hat Enterprise Linux, can also be
	used, but the procedures may vary slightly.
	This machine should have a minimum of 2 GB of RAM and 200 GB hard drive
	storage space.
	The IRIS server does not have a GUI interface, so this computer can be
	set up headless.
</p>
<p>
	After the operating system is installed, make sure the hostname is
	configured correctly in DNS.
	The hostname is needed for some configuration files in the following
	steps.
	The following command should display the hostname that can be used to
	access the server:
</p>
<pre class="code">hostname -f</pre>

<h3 id="install_iris">Install IRIS</h3>
<p>
	<a href="http://iris.dot.state.mn.us/rpms/">Download</a> and install
	the IRIS package.
	This should be a file called
	<b>iris-<i>{major}</i>.<i>{minor}</i>.<i>{micro}</i>-<i>{build}</i>.<i>{arch}</i>.rpm</b>.
	The <i>{major}</i>, <i>{minor}</i>, and <i>{micro}</i> version numbers
	and the <i>{build}</i> number can change with each release.
	The system architecture, <i>{arch}</i>, will be <i>noarch</i>,
	since Java is architecture independent.
	It can be installed with the following command (as root):
</p>
<pre class="code">dnf install iris-<i>{major}</i>.<i>{minor}</i>.<i>{micro}</i>-<i>{build}</i>.noarch.rpm</pre>
<p>
	This will install dependencies not already installed, including
	<a href="http://openjdk.java.net">OpenJDK</a>,
	<a href="http://www.postgresql.org">PostgreSQL</a> and
	<a href="http://projects.apache.org/projects/http_server.html">Apache</a>.
</p>
<h3 id="init_iris">Initialize IRIS</h3>
<p>
	Next, you must initialize the IRIS server installation.
	Run the following command (as root):
</p>
<pre class="code">iris_ctl init</pre>
<p>
	This command will perform the following steps:
</p>
<ol>
	<li>
		Update the <code>/etc/iris/iris-client.properties</code> file
		with the server's hostname.
	</li>
	<li>
		Create an SSL key pair for encrypted communication between the
		server and clients.
		The keystore files are
		<code>/etc/iris/iris-server.keystore</code> and
		<code>/etc/iris/iris-client.keystore</code>.
		The keystore passwords are put into
		<code>/etc/iris/iris-server.properties</code> and
		<code>/etc/iris/iris-client.properties</code>.
	</li>
	<li>
		Create a symbolic link to the PostgreSQL JDBC driver to make it
		available to the IRIS server.
	</li>
	<li>
		Create the database cluster and start the PostgreSQL server.
	</li>
	<li>
		Create the <code>osm</code> databsae (for OpenStreetMap data).
	</li>
	<li>
		Create the <code>tms</code> PostgreSQL user, which IRIS uses to
		connect to the database.
	</li>
	<li>
		Create the <code>tms</code> database and populate it using a
		template SQL script.
	</li>
	<li>
		Configure the apache (httpd) and IRIS services to start
		automatically.
	</li>
	<li>
		Create symbolic links to the current IRIS software version.
	</li>
</ol>
<p>
	The command should finish with the following message:
</p>
<pre>Successfully initialized the IRIS server</pre>

<h3 id="server_properties">Server Properties</h3>
<p>
	The IRIS server has a configuration file which controls some of its
	basic settings &mdash; <i>/etc/iris/iris-server.properties</i>.
	Most of the default settings should work, but it may be necessary to
	make some changes.
	The file can be modified using a text editor, such as <i>gedit</i> or
	<i>vi</i>.
</p>
<h4>Internationalization</h4>
<p>
	There are three properties which control internationalization (i18n).
	They are <i>language</i>, <i>country</i> and <i>variant</i>.
	These should only be changed if the IRIS software has been localized
	for a specific locale.
</p>
<h4 id="district">District</h4>
<p>
	This property allows multiple IRIS servers to exist within the same
	organization.
	The default value is <code>tms</code>.
</p>
<h4>HTTP Proxy</h4>
<p>
	These properties can be used when IRIS must connect to HTTP servers
	using a proxy server, due to organization firewall policies.
</p>
<h4>Database Connection</h4>
<p>
	The <i>db.url</i>, <i>db.user</i> and <i>db.password</i> properties
	control how the IRIS server connects to the PostgreSQL database.
	None of these properties should be changed, since they were configured
	earlier by the <code>iris_ctl</code> script.
</p>
<h4 id="sonar_config">SONAR Configuration</h4>
<p>
	The <i>sonar.ldap.urls</i> property can be used to let IRIS pass user
	authentication requests to one or more LDAP servers.
	Multiple URLs must be separated by a space.
	IRIS can manage user accounts and passwords without an LDAP server, but
	this feature allows operators to log into IRIS without requiring them to
	remember an additional user name and password.
	If your organization already has an LDAP server, such as Active
	Directory, you should use that.
</p>
<p>
	The URL protocol is normally <i>ldap:</i>, but must be <i>ldaps:</i>
	for encrypted communication over SSL.
	To use ldaps, you must first import the SSL certificate into the IRIS
	keystore.
	Once you have obtained the SSL certificate for the LDAP server, save it
	as <i>ldap.cert</i>.
	Now you can import it with the following command (as root):
</p>
<pre class="code">keytool -import -alias ldap-cert -keystore /etc/iris/iris-server.keystore -file ldap.cert</pre>
<p>
	The <i>keystore.password</i> is used for accessing keys in
	<code>/etc/iris/iris-server.keystore</code>.
	This password is automatically generated by the <code>iris_ctl</code>
	script.
	It will not need to be changed.
</p>

<h3 id="start_services">Start Services</h3>
<p>
	Finally, the IRIS server can now be started with the following command:
</p>
<pre class="code">systemctl start iris</pre>
<p>
	Check that everything started OK:
</p>
<pre class="code">tail /var/log/iris/iris.stderr
systemctl status iris</pre>
<p>
	This should indicate that IRIS is active and running.
</p>

<h3 id="initial_login">Initial Login</h3>
<p>
	From a client computer with Java installed, point your web browser at
	http://YOUR_SERVER_NAME/iris-client/.
	From there, you should be able to launch the IRIS client Web Start
	application and log in.
</p>
<p>
	Enter <code>admin</code> as the username and <code>atms_242</code> as
	the password for the initial login.
	After <a href="#users_and_roles">creating</a> and logging in with a
	real administrator account, the <code>admin</code> user account should
	be disabled.
</p>

<h2 id="basic_setup">Basic Setup</h2>
<br/>

<h3 id="client_properties">Client Properties</h3>
<p>
	The IRIS server has a configuration file which contains default
	properties for clients &mdash; <i>/etc/iris/iris-client.properties</i>.
	These properties include internationalization, network proxy, and other
	system configuration.
	Note that even though IRIS has been internationalized, it has not yet
	been translated to languages other than english.
</p>
<dl>
	<dt>language</dt>
	<dd>
		ISO 639 alpha-2 or alpha-3 language code.
		E.g., "en", "es", "fr".
	</dd>
	<dt>country</dt>
	<dd>
		ISO 3166 alpha-2 country code or UN M.49 numeric-3 area code.
		E.g., "US", "MX", "CA".
	</dd>
	<dt>variant</dt>
	<dd>
		IETF BCP 47 language variant subtag.
	</dd>
	<dt>district</dt>
	<dd>
		District name.
		Useful in cases where multiple IRIS servers exist within the
		same organization.
	</dd>
	<dt>http.proxy</dt>
	<dd>
		List of HTTP proxy settings (used for downloading map tiles,
		XML files, etc.)
	</dd>
	<dt>http.proxy.whitelist</dt>
	<dd>
		A list of addresses to bypass using proxy server.
		Addresses are in CIDR notation (exact IP, or ranges specified
		such as 192.168.1.0/24).
	</dd>
	<dt>keystore.file</dt>
	<dd>
		URL for the client keystore file.
	</dd>
	<dt>keystore.password</dt>
	<dd>
		Password for the client keystore.
	</dd>
	<dt>sonar.host</dt>
	<dd>
		IP or hostname of the SONAR server.
	</dd>
	<dt>sonar.port</dt>
	<dd>
		TCP port number of the SONAR server.
	</dd>
	<dt>tdxml.detector.url</dt>
	<dd>
		URL for XML detector stream.
	</dd>
	<dt>map.tile.url</dt>
	<dd>
		Base URL for map tileset.
		Must end in "/".
	</dd>
	<dt>video.host</dt>
	<dd>
		IP or hostname of video server/proxy.
	</dd>
	<dt>video.port</dt>
	<dd>
		TCP port number of video server/proxy.
	</dd>
	<dt>video.extviewer</dt>
	<dd>
		External video viewer.
	</dd>
	<dt>autologin.username</dt>
	<dd>
		A username to be used for automatic login upon client startup.
		Note: use of this property is a security risk.
	</dd>
	<dt>autologin.password</dt>
	<dd>
		A password to be used for automatic login upon client startup.
		Note: use of this property is a security risk.
	</dd>
	<dt>tab.list</dt>
	<dd>
		A list specifying the visibility and ordering of the primary UI
		tabs in the IRIS client.
		The default value is:
		<code>incident, dms, camera, lcs, ramp.meter, gate.arm, r_node,
		      action.plan, comm</code>
	</dd>
	<dt>scale</dt>
	<dd>
		User interface scaling factor (0.25 to 4.0).
		Useful for Hi-DPI screens.
	</dd>
</dl>

<h3 id="user_properties">User Properties</h3>
<p>
	The IRIS client also reads a property file on client computers.
	The file is named "user.properties", and can be found in the "iris"
	folder of the user's home directory.
	It can contain overrides for any of the default values in the
	<a href="#client_properties">client properties</a> file.
	The file is overwritten when logging out.
	The window geometry and last selected tab will be updated,
	but all other properties will be left unchanged.
</p>

<h3 id="edit_mode">Edit Mode</h3>
<p>
	There is an <b>edit mode</b> toggle button on the lower-right corner of
	the IRIS client.
	When the edit mode is <b>OFF</b>, all configuration changes will be
	disallowed.
	This feature prevents administrators from accidentally modifying the
	system while looking up information.
	It is recommended to only turn the edit mode <b>ON</b> while updating
	the system configuration.
	Note: edit mode does not grant any capabilities which are not already
	associated with the <a href="#users_and_roles">user's role</a>.
</p>

<h3 id="sys_attr">System Attributes</h3>
<aside>
	Select <span class="menu">View ➔ System ➔ System Attributes</span> menu
	item
</aside>
<p>
	A <b>system attribute</b> is a configurable value which can be used to
	customize an IRIS system.
	Each system attribute has a corresponding type: string, boolean,
	integer or floating point number.
	String values are limited to 64 characters or less.
	Boolean values must be specified as either <code>true</code> or
	<code>false</code>.
	Many numeric system attributes are constrained to a range of values
	within a minimum and maximum bound, depending on the attribute.
	A system attribute can be customized by updating the value in the table
	on the System Attributes form.
	When a system attribute has been modified from its default value, it
	will be displayed <b>in bold</b>.
	Most attribute changes take effect immediately, but some require the
	IRIS client or server to be restarted. Some System Attributes are
	described in more detail below.
</p>

<h3 id="users_and_roles">Users and Roles</h3>
<aside>
	Select <span class="menu">View ➔ System ➔ Users and Roles</span>
	menu item
</aside>
<p>
	IRIS contains a set of user accounts which are allowed to access the
	system.
	Each account must be assigned to a specific <a href="#roles">role</a>.
	During login, the user account is checked for validity.
	For a successful login, the user and role must both be enabled.
	If the user has a "distinguished name" (dn), then authentication is
	performed using <a href="#sonar_config">LDAP</a>.
	Otherwise, the supplied password is checked against the stored password
	hash for the account.
</p>
<h4 id="roles">Roles</h4>
<p>
	A role defines the set of <a href="#capabilities">capabilities</a>
	associated with a user account (any other capabilities will not be
	available).
	The default roles are <code>administrator</code> and
	<code>operator</code>.
	The <code>administrator</code> role has <a href="#capabilities">
	capabilities</a> which allow unfettered access to the system.
	Other roles can be created to allow different capability sets for users,
	as needed.
	<b>WARNING: if the administrator role or admin user are disabled,
	the ability to make further changes will be lost immediately.</b>
</p>
<h4 id="capabilities">Capabilities</h4>
<p>
	A capability is a set of <a href="#privileges">privileges</a> which can
	be associated with roles.
	It grants all necessary privileges to perform a specific user task.
	There are typically 3 capabilities for each device type:
	<dl>
	<dt><code>_tab</code></dt>
	<dd>Grant <b>view</b> privileges</dd>
	<dt><code>_control</code></dt>
	<dd>Grant <b>control</b> privileges</dd>
	<dt><code>_admin</code></dt>
	<dd>Grant <b>administration</b> privileges</dd>
	</dl>
	Capabilities can be disabled, preventing all users from having access to
	them.
	For example, if a system does not contain any LCS devices, the
	<code>lcs_tab</code> capability could be disabled, preventing that tab
	from appearing in the user interface for any users.
	<b>WARNING: the <code>base_admin</code> capability can grant access for
	all IRIS functions.</b>
</p>
<h4 id="privileges">Privileges</h4>
<p>
	A privilege grants read or write access to one type of object.
	There are 5 fields required to fully specify a privilege.
	<dl>
	<dt>Type</dt>
	<dd>Object type can be selected from a list of available types.</dd>
	<dt>Object</dt>
	<dd>A regular expression used to match object names.
	    NOTE: Write access only.
	    This feature will be removed in a future version of IRIS.
	</dd>
	<dt>Group</dt>
	<dd>Group names are used to divide objects into related groups.
	    This is an experimental feature intended to replace the
	    <b>object</b> field.
	    NOTE: Write access only.
	    <table>
	    <tr>
	    <th>Type</th>
	    <th>Group</th>
	    <th>Description</th>
	    </tr>
	    <tr>
	    <td>play_list</td>
	    <td>user</td>
	    <td>Personal camera <a href="video.html#play-lists">play list</a></td>
	    </table>
	</dd>
	<dt>Attribute</dt>
	<dd>Write access to a specific attribute of an object type can be
	    specified with this field.
	</dd>
	<dt>Write</dt>
	<dd>When this checkbox is checked, write access is granted.
	    Otherwise, the privilege grants read access.
	    To be granted write access, a role must also have read access to
	    the object type.
	</dl>
</p>

<h3 id="mapping">Mapping</h3>
<p>
	The IRIS client can use map tiles to display high-quality maps as a
	background layer.
	The map tiles are fetched from a web server on demand as the client map
	is panned and zoomed.
	The tiles can be generated from <a href="http://openstreetmap.org">
	OpenStreetMap</a> (OSM) data.
	The following instructions describe one method of generating the map
	tiles on Fedora 29.
</p>

<h4>Get OSM data for your region</h4>
<p>
	Download the latest OSM data from
	<a href="http://download.geofabrik.de/">Geofabrik</a>.
	Find the sub-region of interest -- for example, data for Minnesota is at
	<a href="http://download.geofabrik.de/north-america/us/minnesota.html">
	http://download.geofabrik.de/north-america/us/minnesota.html</a>.
	This file is 164 MB as of December 2018.
</p>

<h4>Import OSM Data</h4>
<p>
	The time required to for this process varies depending on the amount of
	data.
	For Minnesota, it takes about 5 minutes on a beefy server.
</p>
<pre class="code">
su --login postgres
time osm2pgsql -v --number-processes=8 -d osm -s --drop --multi-geometry ./minnesota-20181219.osm.pbf
</pre>

<h4>Build and install mapnik library from source</h4>
<p>
	See the mapnik <a href="https://github.com/mapnik/mapnik/wiki/Mapnik-Installation">install docs</a>. The <a href="https://gist.github.com/springmeyer/3427021">Springmeyer docs</a> are also very useful.
</p>
<pre class="code">
dnf install mapnik
</pre>

<h4>Install mapnik tools</h4>
<p>
	See <a href="https://github.com/mapnik/mapnik/blob/v2.2.0/INSTALL.md">docs</a>.
</p>
<pre class="code">
sudo dnf -y install svn
cd ~/osm
svn export http://svn.openstreetmap.org/applications/rendering/mapnik
# Install prepared world boundary data
cd ~/osm/mapnik
mkdir world_boundaries
wget http://tile.openstreetmap.org/world_boundaries-spherical.tgz
tar xvzf world_boundaries-spherical.tgz
wget http://tile.openstreetmap.org/processed_p.tar.bz2
tar xvjf processed_p.tar.bz2 -C world_boundaries
wget http://tile.openstreetmap.org/shoreline_300.tar.bz2
tar xjf shoreline_300.tar.bz2 -C world_boundaries
wget http://www.naturalearthdata.com/http//www.naturalearthdata.com/download/10m/cultural/ne_10m_populated_places.zip
unzip ne_10m_populated_places.zip -d world_boundaries
wget http://www.naturalearthdata.com/http//www.naturalearthdata.com/download/110m/cultural/ne_110m_admin_0_boundary_lines_land.zip
unzip ne_110m_admin_0_boundary_lines_land.zip  -d world_boundaries
</pre>

<h4>Patch osm.xml to create iris_osm.xml</h4>
<pre class="code">
cd ~/osm/mapnik/
cp osm.xml iris_osm.xml
# these patches are optional
patch -p0 &lt; ../01_drop_junc_power_layers.patch
patch -p0 &lt; ../02_interstate_shields.patch
patch -p0 &lt; ../03_trunk_shields.patch
patch -p0 &lt; ../04_cty_rd_shields.patch
patch -p0 &lt; ../05_motorway_color.patch
patch -p0 &lt; ../06_trunk_color.patch
patch -p0 &lt; ../07_primary_color.patch
patch -p0 &lt; ../08_secondary_color.patch
patch -p0 &lt; ../09_tertiary_color.patch
</pre>

<h4>Copy symbols used for roadway shields</h4>
<p>
	FIXME
</p>

<h4>Generate tiles</h4>
<p>
	Generating tiles takes about 2 hours on a 16 processor system, or about 13K tiles/min.
</p>
<pre class="code">
su - tms
cd ~/osm/mapnik
export MAPNIK_MAP_FILE=~/osm/mapnik/iris_osm.xml
export MAPNIK_TILE_DIR=/home/tms/osm/tiles
# Customize osm.xml
./generate_xml.py  --dbname osm --accept-none
vim generate_tiles_multiprocess.py
	NUM_THREADS = number of processors in your server
	bbox = (-97.5, 43.0, -89.0, 49.5)
	minZoom = 6
	maxZoom = 16
	# comment all of the european cities listed
time ./generate_tiles_multiprocess.py
# Copy tiles to server hosting them
scp -rp ~/osm/tiles/* root@tilehost:/var/www/html/
</pre>

<h4>Create Map Extents in IRIS database</h4>
<aside>
	Select <span class="menu">View ➔ System ➔ Map Extents</span> menu item
</aside>
<p>
	This form enables the creation of map extents, which are buttons
	allowing quick selection of a map location and zoom level.
	Each map extent will be displayed as a button on the upper right area
	of the map (next to the zoom in/out buttons).
	First, a "Home" extent should be created, which is selected by default
	when a user logs in.
	Other extents can also be created for commonly selected map spots.
</p>

<h3 id="comm_links">Comm Links</h3>
<aside>
	Select <span class="menu">View ➔ Maintenance ➔ Comm Links</span> menu
	item
</aside>
<p>
	A <b>comm link</b> is a network connection to an external device or
	system.
	IRIS is capable of supporting hundreds of simultaneous comm links.
</p>
<p>
	The URI includes a DNS host name or network IP address, and port number,
	using the standard <code>host:port</code> convention.
	The URI can also contain an optional <b>scheme</b> prefix, which can be
	either <code>udp://</code>, <code>tcp://</code> or <code>modem://</code>.
	If present, the scheme will override the <b>default scheme</b> for the
	selected protocol.
	For example, to use the <a href="#pelcod">Pelco-D</a> protocol over TCP
	(instead of the default UDP), prepend <code>tcp://</code> to the URI.
</p>
<p>
	<b>Protocol</b> determines what type of device or system is on the other
	end of the comm link.
	The following table contains the communication protocols supported by
	IRIS:
</p>
<table id="prot_table">
	<tr>
	    <th>Protocol</th>
	    <th>Default Scheme</th>
	    <th><a href="controllers.html#drop-address">Drop Address</a></th>
	    <th>Devices</th>
	    <th><a href="controllers.html#io-pins">I/O Pins</a></th>
	</tr>
	<tr id="ntcip">
	    <td>NTCIP A</td>
	    <td>udp</td>
	    <td>N/A</td>
	    <td rowspan="3"><a href="dms.html">DMS</a>,
	        <a href="lcs.html#intelligent-lcs">Intelligent LCS</a>,
	        <a href="rwis.html">RWIS</a>,
	        <a href="vehicle_detection.html">VDS</a>,
	        <a href="gps.html">GPS</a>
	    </td>
	    <td rowspan="4">1</td>
	</tr>
	<tr>
	    <td>NTCIP B</td>
	    <td>tcp</td>
	    <td>1-8191</td>
	</tr>
	<tr>
	    <td>NTCIP C</td>
	    <td>tcp</td>
	    <td>N/A</td>
	</tr>
	<tr id="dms_xml">
	    <td>DMS-XML</td>
	    <td>tcp</td>
	    <td>0-65535</td>
	    <td><a href="dms.html">DMS</a></td>
	</tr>
	<tr id="mndot170">
	    <td>MnDOT-170 4</td>
	    <td rowspan="2">tcp</td>
	    <td>1-15</td>
	    <td rowspan="2"><a href="vehicle_detection.html">VDS</a>,
	        <a href="ramp_meters.html">Ramp Meters</a>,
		<a href="beacons.html">beacons</a>,
	        <a href="lcs.html#changeable-lcs">Changeable LCS</a>,
		<a href="alarms.html">alarms</a>
	    </td>
	    <td rowspan="2"><a href="#mndot_pins">[*]</a</td>
	</tr>
	<tr>
	    <td>MnDOT-170 5</td>
	    <td>1-31</td>
	</tr>
	<tr id="ss105">
	    <td>SS105</td>
	    <td>tcp</td>
	    <td>1-9999</td>
	    <td rowspan="6"><a href="vehicle_detection.html">VDS</a></td>
	    <td rowspan="2">1-8</td>
	</tr>
	<tr id="ss125">
	    <td>SS125</td>
	    <td>tcp</td>
	    <td>0-65535</td>
	</tr>
	<tr id="g4">
	    <td>G4</td>
	    <td>tcp</td>
	    <td>0-65535</td>
	    <td>1-12</td>
	</tr>
	<tr id="canoga">
	    <td>Canoga</td>
	    <td>tcp</td>
	    <td>1-255</td>
	    <td>1-4</td>
	</tr>
	<tr id="dr500">
	    <td>DR-500</td>
	    <td>tcp</td>
	    <td>N/A</td>
	    <td>1</td>
	</tr>
	<tr id="dxm">
	    <td>DXM</td>
	    <td>tcp</td>
	    <td>N/A</td>
	    <td>11-86</td>
	</tr>
	<tr id="axis_ptz">
	    <td>Axis-PTZ</td>
	    <td>http</td>
	    <td>N/A</td>
	    <td rowspan="6"><a href="cameras.html#pan-tilt-and-zoom">PTZ</a></td>
	    <td rowspan="6">1</td>
	</tr>
	<tr id="pelcod">
	    <td>Pelco-D</td>
	    <td>udp</td>
	    <td>1-254</td>
	</tr>
	<tr id="manchester">
	    <td>Manchester</td>
	    <td>udp</td>
	    <td>1-1024</td>
	</tr>
	<tr id="vicon">
	    <td>Vicon</td>
	    <td>udp</td>
	    <td>1-254</td>
	</tr>
	<tr id="cohu">
	    <td>Cohu</td>
	    <td>tcp</td>
	    <td>1-223</td>
	</tr>
	<tr id="infinova">
	    <td>Infinova</td>
	    <td>tcp</td>
	    <td>1-254</td>
	</tr>
	<tr id="pelcop">
	    <td>Pelco-P</td>
	    <td>tcp</td>
	    <td>N/A</td>
	    <td><a href="cameras.html#camera-keyboards">Camera KBD</a></td>
	    <td>N/A</td>
	</tr>
	<tr>
	    <td><a href="video.html#monstream">MonStream</a></td>
	    <td>udp</td>
	    <td>N/A</td>
	    <td><a href="video.html">Monitors</a></td>
	    <td>1-16</td>
	</tr>
	<tr id="stc">
	    <td>STC</td>
	    <td>tcp</td>
	    <td>1-99</td>
	    <td><a href="gate_arms.html">Gate Arm</a></td>
	    <td rowspan="3">1</td>
	</tr>
	<tr id="e6">
	    <td>E6</td>
	    <td>udp</td>
	    <td>N/A</td>
	    <td><a href="tolling.html#tag-readers">Tag Reader</a></td>
	</tr>
	<tr id="redlion">
	    <td>RedLion</td>
	    <td>tcp</td>
	    <td>N/A</td>
	    <td><a href="gps.html">GPS</a></td>
	</tr>
	<tr id="sierragx">
	    <td>SierraGX</td>
	    <td>tcp</td>
	    <td>N/A</td>
	    <td><a href="gps.html">GPS</a></td>
	</tr>
	<tr id="dinrelay">
	    <td>DIN-Relay</td>
	    <td>http</td>
	    <td>N/A</td>
	    <td><a href="lcs.html#changeable-lcs">Changeable LCS</a>,
	        <a href="beacons.html">beacons</a>
	    </td>
	    <td rowspan="2">1-8</td>
	</tr>
	<tr id="cbw">
	    <td>CBW</td>
	    <td>http</td>
	    <td>N/A</td>
	    <td><a href="beacons.html">beacons</a></td>
	</tr>
	<tr id="org815">
	    <td>Org-815</td>
	    <td>tcp</td>
	    <td>N/A</td>
	    <td><a href="rwis.html">RWIS</a></td>
	    <td rowspan="3">1</td>
	</tr>
	<tr id="msgfeed">
	    <td>Msg-Feed</td>
	    <td>http</td>
	    <td>N/A</td>
	    <td><a href="#msg_feed">DMS messages</a></td>
	</tr>
	<tr id="incfeed">
	    <td>Inc-Feed</td>
	    <td>http</td>
	    <td>N/A</td>
	    <td><a href="#inc_feed">Incidents</a></td>
	</tr>
</table>

<p/>
<h5 id="mndot_pins">I/O Pins For MnDOT-170 Protocol</h5>
<table>
	<tr>
	    <th>Device Type</th>
	    <th>I/O Pin(s)</th>
	</tr>
	<tr>
	    <td><a href="ramp_meters.html">Ramp Meter</a></td>
	    <td>2 or 3</td>
	</tr>
	<tr>
	    <td><a href="beacons.html">Beacon</a></td>
	    <td>2</td>
	</tr>
	<tr>
	    <td><a href="lcs.html#changeable-lcs">Changeable LCS</a></td>
	    <td>19 - 36</td>
	</tr>
	<tr>
	    <td><a href="vehicle_detection.html">VDS</a></td>
	    <td>39 - 62</td>
	</tr>
	<tr>
	    <td><a href="alarms.html">Alarms</a></td>
	    <td>70 - 79</td>
	</tr>
</table>
<p/>
<p id="poll_period">
	Poll <b>period</b> determines how frequently controllers on a comm
	link are polled.
	It can range from 5 seconds to 24 hours.
	After a poll, if a response is not received before the <b>timeout</b>
	expires, the communicaton will fail.
	For each poll, 2 retries will happen before the operation is aborted.
</p>

<h4 id="msg_feed">DMS Message Feed Protocol</h4>
<p>
	The <b>Msg-Feed</b> protocol can be used to interface IRIS with an
	external system that generates <a href="dms.html">DMS</a> messages.
	Periodically, IRIS will poll the URI (using HTTP) for DMS messages.
	The external system should respond with an ASCII text file, with one
	line per message to be deployed.
</p>
<p>
	Each line must contain 3 fields, separated by tab characters
	<code>\t</code> (ASCII 0x09), and terminated with a single newline
	character <code>\n</code> (ASCII 0x0A).
	The fields are DMS name, <a href="dms.html#multi">MULTI</a> string, and
	expiration time.
	The DMS name must exactly match one of the DMS as identified by IRIS.
	The MULTI string specifies a message to display on the sign, using the
	MULTI markup language, from NTCIP 1203.
	For example, "ROAD CLOSED[nl]AHEAD[nl]LEFT LANE CLOSED" is a valid
	three-line MULTI message.
	The expiration field indicates the date and time that the message
	should expire.
	It is in <code>yyyy-MM-dd HH:mm:ssZ</code> format, which includes date,
	time and time zone.
	A valid expiration time would be 2012-05-15 11:37:00-0600.
</p>
<p>
	There are a couple of other required steps to enable a message feed
	to operate.
	First, an <a href="action_plans.html">action plan</a> must be created
	which associates a <a href="action_plans.html#dms-actions">DMS action</a>
	with the message feed.
	The DMS action must be associated with a <a href="dms.html#quick-messages">quick
	message</a> that references the message feed, using a <b>feed</b>
	<a href="action_plans.html#dms-action-tags">action tag</a>.
	So, if the message feed is on a Comm Link called <code>LFEED</code>,
	then the quick message MULTI string must be <code>[feedLFEED]</code>.
	Also, the action plan must be active and deployed.
	This requirement allows only administrator-approved DMS to be controlled
	by the message feed.
</p>
<p>
	The other requirement for message feeds is that all messages used by
	the feed must be defined in the DMS message library.
	This requirement allows only administrator-approved messages to be
	deployed by the message feed.
	In some circumstances, it may be appropriate to disable this checking.
	For example, if the message feed host is fully trusted and there is no
	possibility of man-in-the-middle attacks between IRIS and the feed host.
	In this case <a href="#sys_attr"><code>msg_feed_verify</code></a> can be
	set to <code>false</code> to disable this check.
</p>
<p>
	To control DMS <a href="beacons.html">beacon</a> activation through a
	message feed, configure 2 message feeds. One message feed is for DMS 
	containing messages with activated beacons and the other
	for messages with deactivated beacons. There is no way to 
	control which message feed is executed first, so each
	message feed must list each DMS and at least one of the 
	message feeds must contain a blank MULTI for each DMS. 
</p>

<h4 id="inc_feed">Incident Feed Protocol</h4>
<p>
	The <b>Inc-Feed</b> protocol can be used to interface IRIS with an
	external system that generates <a href="incidents.html">incidents</a>.
	Periodically, IRIS will poll the URI (using HTTP) for incidents.
	The external system should respond with an ASCII text file, with one
	line per active incident.
</p>
<p>
	Each line should contain 6 fields, separated by comma characters
	"<code>,</code>" and terminated with a single newline character
	<code>\n</code> (ASCII 0x0A).
	The fields are incident ID, type, incident detail, latitude, longitude,
	and camera ID.
	The type must be CRASH, STALL, ROADWORK, or HAZARD.
	The detail may be blank, or one of the incident detail names.
	Latitude and longitude must be coördinates of the incident.
	Camera ID may be blank, or the ID of a camera to view the incident.
</p>

</main>

</body>
</html>
